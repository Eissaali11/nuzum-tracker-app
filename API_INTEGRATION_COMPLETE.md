# โ ุชู ุฑุจุท API ุจูุฌุงุญ - API Integration Complete

## ๐ ููุฎุต ุงูุชุญุฏูุซุงุช

ุชู ุชุญุฏูุซ ุงูุชุทุจูู ุจุงููุงูู ูุงุณุชุฎุฏุงู API ุงูุดุงูู ุงูุฌุฏูุฏ ูุน ุฌููุน ุงูููุฒุงุช ุงููุทููุจุฉ.

---

## ๐ ูุนูููุงุช ุงูุงุชุตุงู

### ุงูุฑูุงุจุท ุงููุญุฏุซุฉ:
- **ุงูุฑุงุจุท ุงูุฃุณุงุณู:** `http://nuzum.site/api/external/employee-complete-profile`
- **ุงูุฑุงุจุท ุงูุงุญุชูุงุทู:** `https://eissahr.replit.app/api/external/employee-complete-profile`
- **ููุชุงุญ API:** `test_location_key_2025`

### ูุธุงู ุงูุชุจุฏูู ุงูุชููุงุฆู:
โ ุงูุชุทุจูู ูุญุงูู ุงูุงุชุตุงู ุจุงูุฑุงุจุท ุงูุฃุณุงุณู ุฃููุงู  
โ ูู ุญุงูุฉ ุงููุดูุ ููุชูู ุชููุงุฆูุงู ููุฑุงุจุท ุงูุงุญุชูุงุทู  
โ ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก ูุน ุฑุณุงุฆู ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ

---

## ๐ฆ ุงูุจูุงูุงุช ุงููุฑููุฉ

### ูุนูููุงุช ุงูููุธู ุงููุงููุฉ:
- โ ุงูุงุณู (ุนุฑุจู ูุฅูุฌููุฒู)
- โ ุฑูู ุงููููุฉ
- โ ุชุงุฑูุฎ ุงููููุงุฏ
- โ ุชุงุฑูุฎ ุงูุชูุธูู
- โ ุงูุฌูุณูุฉ
- โ ุชุงุฑูุฎ ุงูุชูุงุก ุงูุฅูุงูุฉ
- โ ุงุณู ุงููููู
- โ ุฑูู ุฌูุงู ุฃุจุดุฑ
- โ ุงูุฏุงุฆุฑุฉ (ุนุฑุจู ูุฅูุฌููุฒู)
- โ ุงููุณู (ุนุฑุจู ูุฅูุฌููุฒู)
- โ ุงููุณูู ุงููุธููู
- โ ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ
- โ ุตูุฑุฉ ุงููููุฉ
- โ ุตูุฑุฉ ุงูุฑุฎุตุฉ (ุฅุฐุง ูุงู ุณุงุฆู)

### ุงูุจูุงูุงุช ุงููุฑุชุจุทุฉ:
- โ ุงูุณูุงุฑุฉ ุงูุญุงููุฉ
- โ ุงูุณูุงุฑุงุช ุงูุณุงุจูุฉ
- โ ุณุฌู ุงูุญุถูุฑ ุงูุดูุฑู
- โ ุณุฌู ุงูุฑูุงุชุจ
- โ ุนูููุงุช ุงูุชุณููู ูุงูุงุณุชูุงู
- โ ุงูุฅุญุตุงุฆูุงุช ุงูุดุงููุฉ

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ูู ุตูุญุฉ ุงูููุธู (EmployeeProfileScreen):

```dart
// ูุชู ุงุณุชุฎุฏุงู getCompleteProfile ุชููุงุฆูุงู
// ูุฌูุจ ุฌููุน ุงูุจูุงูุงุช ูู ุทูุจ ูุงุญุฏ
final completeResponse = await EmployeeApiService.getCompleteProfile(
  jobNumber: '5216',
  apiKey: 'test_location_key_2025',
  month: '2025-01', // ุงุฎุชูุงุฑู - ููุญุถูุฑ ูุงูุฑูุงุชุจ ุงูุดูุฑูุฉ
);
```

### 2. ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช:

```dart
if (completeResponse.success && completeResponse.data != null) {
  final data = completeResponse.data!;
  
  // ูุนูููุงุช ุงูููุธู
  print(data.employee.name); // ุงูุงุณู
  print(data.employee.nameEn); // ุงูุงุณู ุจุงูุฅูุฌููุฒู
  print(data.employee.nationalId); // ุฑูู ุงููููุฉ
  print(data.employee.birthDate); // ุชุงุฑูุฎ ุงููููุงุฏ
  print(data.employee.hireDate); // ุชุงุฑูุฎ ุงูุชูุธูู
  print(data.employee.nationality); // ุงูุฌูุณูุฉ
  print(data.employee.residenceExpiryDate); // ุชุงุฑูุฎ ุงูุชูุงุก ุงูุฅูุงูุฉ
  print(data.employee.sponsorName); // ุงุณู ุงููููู
  print(data.employee.absherPhone); // ุฑูู ุฌูุงู ุฃุจุดุฑ
  print(data.employee.department); // ุงูุฏุงุฆุฑุฉ
  print(data.employee.section); // ุงููุณู
  
  // ุงูุณูุงุฑุฉ ุงูุญุงููุฉ
  if (data.currentCar != null) {
    print(data.currentCar!.plateNumber);
  }
  
  // ุงูุณูุงุฑุงุช ุงูุณุงุจูุฉ
  print(data.previousCars.length);
  
  // ุงูุญุถูุฑ
  print(data.attendance.length);
  
  // ุงูุฑูุงุชุจ
  print(data.salaries.length);
  
  // ุงูุนูููุงุช
  print(data.operations.length);
  
  // ุงูุฅุญุตุงุฆูุงุช
  print(data.statistics.attendance.attendanceRate);
  print(data.statistics.salaries.totalAmount);
  print(data.statistics.cars.totalCars);
  print(data.statistics.operations.totalOperations);
}
```

### 3. ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:

```dart
if (!completeResponse.success) {
  // ุนุฑุถ ุฑุณุงูุฉ ุงูุฎุทุฃ
  print(completeResponse.error);
  
  // ูููู ุงูุชุญูู ูู ููุน ุงูุฎุทุฃ
  if (completeResponse.error?.contains('503') ?? false) {
    // ุงูุฎุฏูุฉ ุบูุฑ ูุชุงุญุฉ
  } else if (completeResponse.error?.contains('401') ?? false) {
    // ุบูุฑ ูุตุฑุญ
  }
}
```

---

## ๐ง ุงููููุงุช ุงููุญุฏุซุฉ

### 1. `lib/config/api_config.dart`
- โ ุชุญุฏูุซ ุงูุฑุงุจุท ุงูุฃุณุงุณู ุฅูู `http://nuzum.site`
- โ ุฅุถุงูุฉ ุฑุงุจุท ุงุญุชูุงุทู ููุทูุจ ุงูุดุงูู

### 2. `lib/services/employee_api_service.dart`
- โ ุฅุถุงูุฉ ุฏุงูุฉ `getCompleteProfile()` ูุน ูุธุงู ุชุจุฏูู ุชููุงุฆู
- โ ุฅุถุงูุฉ ุฏุงูุฉ `_tryBackupCompleteProfile()` ููุฑุงุจุท ุงูุงุญุชูุงุทู
- โ ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก

### 3. `lib/models/employee_model.dart`
- โ ุฅุถุงูุฉ ุฌููุน ุงูุญููู ุงููุทููุจุฉ:
  - `nameEn`, `nationalId`, `birthDate`, `hireDate`
  - `nationality`, `residenceExpiryDate`, `sponsorName`, `absherPhone`
  - `section`, `sectionEn`

### 4. `lib/models/complete_employee_response.dart`
- โ ูููุฐุฌ ุดุงูู ููุงุณุชุฌุงุจุฉ
- โ ุฅุญุตุงุฆูุงุช ููุตูุฉ

### 5. `lib/models/operation_model.dart`
- โ ุฅุถุงูุฉ `carId` ู `carPlateNumber`

### 6. `lib/screens/employee_profile_screen.dart`
- โ ุชุญุฏูุซ ูุงุณุชุฎุฏุงู `getCompleteProfile()` ุจุฏูุงู ูู ุนุฏุฉ ุทูุจุงุช
- โ ุงุณุชุฎุฏุงู `SafePreferences` ุจุฏูุงู ูู `SharedPreferences` ูุจุงุดุฑุฉ

---

## โ ุงูููุฒุงุช ุงููุถุงูุฉ

### 1. ูุธุงู ุงูุชุจุฏูู ุงูุชููุงุฆู:
- ูุญุงูู ุงูุงุชุตุงู ุจุงูุฑุงุจุท ุงูุฃุณุงุณู ุฃููุงู
- ูู ุญุงูุฉ ุงููุดู ุฃู 503ุ ููุชูู ููุฑุงุจุท ุงูุงุญุชูุงุทู ุชููุงุฆูุงู
- ูุง ูุญุชุงุฌ ุงููุณุชุฎุฏู ูุฃู ุชุฏุฎู

### 2. ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ
- ูุนุงูุฌุฉ ุฎุงุตุฉ ูุญุงูุฉ 503 (Service Unavailable)
- ุชุณุฌูู ุงูุฃุฎุทุงุก ูู console ููุชุตุญูุญ

### 3. ุงูุฃุฏุงุก:
- ุทูุจ ูุงุญุฏ ุจุฏูุงู ูู 5 ุทูุจุงุช ูููุตูุฉ
- ุฃุณุฑุน ูู ุงูุชุญููู
- ุชูููู ุงุณุชููุงู ุงูุจูุงูุงุช

---

## ๐งช ุงุฎุชุจุงุฑ ุงูุงุชุตุงู

### ูุซุงู ููุงุฎุชุจุงุฑ:

```dart
void testConnection() async {
  final response = await EmployeeApiService.getCompleteProfile(
    jobNumber: '5216',
    apiKey: 'test_location_key_2025',
  );
  
  if (response.success) {
    print('โ ุงูุงุชุตุงู ูุฌุญ!');
    print('ุงูููุธู: ${response.data!.employee.name}');
    print('ุนุฏุฏ ุณุฌูุงุช ุงูุญุถูุฑ: ${response.data!.attendance.length}');
    print('ุนุฏุฏ ุงูุฑูุงุชุจ: ${response.data!.salaries.length}');
    print('ุนุฏุฏ ุงูุณูุงุฑุงุช: ${response.data!.previousCars.length + (response.data!.currentCar != null ? 1 : 0)}');
    print('ุนุฏุฏ ุงูุนูููุงุช: ${response.data!.operations.length}');
  } else {
    print('โ ูุดู ุงูุงุชุตุงู: ${response.error}');
  }
}
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุฑูุงุจุท:** ุชู ุชุญุฏูุซ ุงูุฑุงุจุท ุงูุฃุณุงุณู ุฅูู `http://nuzum.site`
2. **ุงูุชุจุฏูู ุงูุชููุงุฆู:** ูุนูู ุชููุงุฆูุงู ุจุฏูู ุฃู ุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ
3. **Timeout:** 30 ุซุงููุฉ ููู ุทูุจ
4. **ุงูุชุตููุฉ:** ูููู ุชุตููุฉ ุงูุญุถูุฑ ูุงูุฑูุงุชุจ ุจุงูุดูุฑ ุฃู ุงููุทุงู ุงูุฒููู

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. โ ุชู ุฑุจุท API ุจูุฌุงุญ
2. โ ุชู ุชุญุฏูุซ ุฌููุน ุงูููุงุฐุฌ
3. โ ุชู ุชุญุฏูุซ ุตูุญุฉ ุงูููุธู
4. โ ุชู ุฅุถุงูุฉ ูุธุงู ุงูุชุจุฏูู ุงูุชููุงุฆู
5. โ ุฌุงูุฒ ููุงุฎุชุจุงุฑ

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-01-XX  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุงุณุชุฎุฏุงู

