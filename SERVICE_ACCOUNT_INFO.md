# ğŸ” Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Service Account - Service Account Information

## ğŸ“‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Service Account

### Service Account Email:
```
nuzum-721@nuzum-477618.iam.gserviceaccount.com
```

### Project ID:
```
nuzum-477618
```

### Project Name:
```
nuzum
```

---

## ğŸ“ Google Drive Folder

### Folder ID:
```
1AvaKUW2VKb9t4O4Dwo_KXTntBfDQ1IYe
```

### Folder Link:
https://drive.google.com/drive/folders/1AvaKUW2VKb9t4O4Dwo_KXTntBfDQ1IYe?usp=sharing

---

## ğŸ”§ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ ÙÙŠ Backend (Replit)

### âš ï¸ ØªØ­Ø°ÙŠØ± Ø£Ù…Ù†ÙŠ Ù…Ù‡Ù…

**Ù„Ø§ ØªØ­ÙØ¸ Service Account JSON ÙÙŠ Ø§Ù„ÙƒÙˆØ¯!**
- Private Key ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø±Ø§Ø¬Ù‡Ø§ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø¨Ø³Ù‡ÙˆÙ„Ø©
- Ø§Ø³ØªØ®Ø¯Ù… Replit Secrets ÙÙ‚Ø·
- Ù„Ø§ ØªØ±ÙØ¹ Private Key Ø¹Ù„Ù‰ GitHub

---

### 1. Ø¥Ø¶Ø§ÙØ© Service Account Ø¥Ù„Ù‰ Replit Secrets

ÙÙŠ ReplitØŒ Ø£Ø¶Ù Service Account JSON ÙÙŠ Secrets:

#### Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:

1. Ø§ÙØªØ­ Replit
2. Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ "Secrets" (ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©)
3. Ø£Ø¶Ù Secret Ø¬Ø¯ÙŠØ¯:
   - **Key**: `GOOGLE_SERVICE_ACCOUNT`
   - **Value**: (Ø§Ù†Ø³Ø® Service Account JSON ÙƒØ§Ù…Ù„Ø§Ù‹ - Ø§Ù†Ø¸Ø± Ø£Ø¯Ù†Ø§Ù‡)

#### Service Account JSON (Ù„Ù„Ù†Ø³Ø®):

**âš ï¸ ØªØ­Ø°ÙŠØ± Ø£Ù…Ù†ÙŠ**: Private Key Ù…Ø­Ø°ÙˆÙ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø£Ù…Ù†ÙŠØ©. Ø§Ø³ØªØ®Ø¯Ù… Service Account JSON Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ù† Google Cloud Console.

**ğŸ“‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Service Account:**
- **Project ID**: `nuzum-477618`
- **Service Account Email**: `nuzum-721@nuzum-477618.iam.gserviceaccount.com`
- **Private Key ID**: `4ef8877f3c0ac1b316594e019ed97e4eb4f03e68`
- **Client ID**: `108366574147056527902`

**ğŸ“ Service Account JSON Template:**

Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Service Account JSON Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ù† Google Cloud Console ÙˆØ§Ø³ØªØ®Ø¯Ù…Ù‡ ÙÙŠ Replit Secrets:

```json
{
  "type": "service_account",
  "project_id": "nuzum-477618",
  "private_key_id": "[YOUR_PRIVATE_KEY_ID]",
  "private_key": "-----BEGIN PRIVATE KEY-----\n[YOUR_PRIVATE_KEY_HERE]\n-----END PRIVATE KEY-----\n",
  "client_email": "nuzum-721@nuzum-477618.iam.gserviceaccount.com",
  "client_id": "[YOUR_CLIENT_ID]",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/nuzum-721%40nuzum-477618.iam.gserviceaccount.com",
  "universe_domain": "googleapis.com"
}
```

**âš ï¸ Ù…Ù‡Ù…**: 
- Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Service Account JSON Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ù† Google Cloud Console
- Ø§Ù†Ø³Ø® JSON ÙƒØ§Ù…Ù„Ø§Ù‹ (Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Private Key)
- Ø§Ù„ØµÙ‚Ù‡ ÙÙŠ Replit Secrets ÙƒÙ€ String ÙˆØ§Ø­Ø¯
- Ù„Ø§ ØªØ­ÙØ¸Ù‡ ÙÙŠ Ø£ÙŠ Ù…Ù„Ù ÙÙŠ Ø§Ù„ÙƒÙˆØ¯

### 2. ØªØ­Ø¯ÙŠØ« Folder IDs ÙÙŠ Backend

```python
# ÙÙŠ backend/config.py
INVOICE_DRIVE_FOLDER_ID = "1AvaKUW2VKb9t4O4Dwo_KXTntBfDQ1IYe"
ADVANCE_DRIVE_FOLDER_ID = "1AvaKUW2VKb9t4O4Dwo_KXTntBfDQ1IYe"
CAR_WASH_DRIVE_FOLDER_ID = "1AvaKUW2VKb9t4O4Dwo_KXTntBfDQ1IYe"
INSPECTION_DRIVE_FOLDER_ID = "1AvaKUW2VKb9t4O4Dwo_KXTntBfDQ1IYe"
```

### 3. Ù…Ø«Ø§Ù„ ÙƒÙˆØ¯ Backend

```python
from google.oauth2 import service_account
from googleapiclient.discovery import build
from googleapiclient.http import MediaFileUpload
import json
import os

# ØªØ­Ù…ÙŠÙ„ Service Account Ù…Ù† Replit Secrets
SERVICE_ACCOUNT_INFO = json.loads(os.environ['GOOGLE_SERVICE_ACCOUNT'])

SCOPES = ['https://www.googleapis.com/auth/drive.file']
credentials = service_account.Credentials.from_service_account_info(
    SERVICE_ACCOUNT_INFO,
    scopes=SCOPES
)
drive_service = build('drive', 'v3', credentials=credentials)

# Folder ID
INVOICE_DRIVE_FOLDER_ID = "1AvaKUW2VKb9t4O4Dwo_KXTntBfDQ1IYe"

@app.route('/api/v1/requests/<int:request_id>/upload-invoice-image', methods=['POST'])
def upload_invoice_image(request_id):
    try:
        file = request.files['file']
        
        file_metadata = {
            'name': f'invoice_{request_id}_{datetime.now().strftime("%Y%m%d_%H%M%S")}.jpg',
            'parents': [INVOICE_DRIVE_FOLDER_ID]
        }
        
        media = MediaFileUpload(file, mimetype=file.content_type)
        result = drive_service.files().create(
            body=file_metadata,
            media_body=media,
            fields='id,webViewLink'
        ).execute()
        
        return jsonify({
            'success': True,
            'drive_url': result.get('webViewLink'),
            'file_id': result.get('id')
        })
    except Exception as e:
        return jsonify({
            'success': False,
            'error': str(e)
        }), 500
```

---

## âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª

### 1. Ø¥Ø¶Ø§ÙØ© Service Account Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¬Ù„Ø¯

1. Ø§ÙØªØ­ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¬Ù„Ø¯: https://drive.google.com/drive/folders/1AvaKUW2VKb9t4O4Dwo_KXTntBfDQ1IYe
2. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ù…Ø´Ø§Ø±ÙƒØ©" (Share)
3. Ø£Ø¶Ù Service Account email: `nuzum-721@nuzum-477618.iam.gserviceaccount.com`
4. Ø§Ø®ØªØ± Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©: "Manager" Ø£Ùˆ "Editor"
5. Ø§Ø¶ØºØ· "Ø¥Ø±Ø³Ø§Ù„" (Send)

### 2. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Google Drive API

1. Ø§ÙØªØ­ Google Cloud Console: https://console.cloud.google.com/
2. Ø§Ø®ØªØ± Project: `nuzum-477618`
3. Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ "APIs & Services" > "Library"
4. Ø§Ø¨Ø­Ø« Ø¹Ù† "Google Drive API"
5. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ù‡ Ù…ÙØ¹Ù„ (Enabled)

### 3. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Service Account

1. Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ "IAM & Admin" > "Service Accounts"
2. Ø§Ø¨Ø­Ø« Ø¹Ù†: `nuzum-721@nuzum-477618.iam.gserviceaccount.com`
3. ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯Ù‡
4. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ù…Ù†ÙˆØ­Ø©

---

## ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±ÙØ¹

### 1. Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Backend

```python
# test_upload.py
import os
import json
from google.oauth2 import service_account
from googleapiclient.discovery import build
from googleapiclient.http import MediaFileUpload

# ØªØ­Ù…ÙŠÙ„ Service Account
SERVICE_ACCOUNT_INFO = json.loads(os.environ['GOOGLE_SERVICE_ACCOUNT'])
credentials = service_account.Credentials.from_service_account_info(
    SERVICE_ACCOUNT_INFO,
    scopes=['https://www.googleapis.com/auth/drive.file']
)
drive_service = build('drive', 'v3', credentials=credentials)

# Ø±ÙØ¹ Ù…Ù„Ù ØªØ¬Ø±ÙŠØ¨ÙŠ
file_metadata = {
    'name': 'test_file.jpg',
    'parents': ['1AvaKUW2VKb9t4O4Dwo_KXTntBfDQ1IYe']
}

media = MediaFileUpload('test_file.jpg', mimetype='image/jpeg')
result = drive_service.files().create(
    body=file_metadata,
    media_body=media,
    fields='id,webViewLink'
).execute()

print(f"âœ… File ID: {result.get('id')}")
print(f"âœ… Drive URL: {result.get('webViewLink')}")
```

### 2. Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Flutter

```dart
// Ø§Ø®ØªØ¨Ø§Ø± Ø±ÙØ¹ ÙØ§ØªÙˆØ±Ø©
final request = InvoiceRequest(
  employeeId: 123,
  vendorName: 'Ù…ÙˆØ±Ø¯ ØªØ¬Ø±ÙŠØ¨ÙŠ',
  amount: 1000.0,
  imagePath: '/path/to/invoice.jpg',
);

final result = await RequestsApiService.createInvoice(
  request,
  onProgress: (sent, total) {
    print('Progress: ${(sent / total * 100).toStringAsFixed(1)}%');
  },
);

if (result['success'] == true) {
  print('âœ… Request ID: ${result['data']['request_id']}');
  if (result['data']['drive_url'] != null) {
    print('âœ… Drive URL: ${result['data']['drive_url']}');
    // ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø±Ø§Ø¨Ø· Ù…Ø«Ù„:
    // https://drive.google.com/file/d/...
  }
}
```

---

## ğŸ” Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ø®Ø·Ø£ 403 (Forbidden)
**Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©**:
- Service Account Ù„ÙŠØ³ Ù„Ø¯ÙŠÙ‡ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¬Ù„Ø¯
- Google Drive API ØºÙŠØ± Ù…ÙØ¹Ù„

**Ø§Ù„Ø­Ù„**:
1. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Service Account Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¬Ù„Ø¯ ÙƒÙ€ "Manager" Ø£Ùˆ "Editor"
2. ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ Google Drive API ÙÙŠ Google Cloud Console

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ø®Ø·Ø£ 404 (Not Found)
**Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©**:
- Folder ID ØºÙŠØ± ØµØ­ÙŠØ­
- Ø§Ù„Ù…Ø¬Ù„Ø¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯

**Ø§Ù„Ø­Ù„**:
1. ØªØ­Ù‚Ù‚ Ù…Ù† Folder ID: `1AvaKUW2VKb9t4O4Dwo_KXTntBfDQ1IYe`
2. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø¬Ù„Ø¯ Ù…ÙˆØ¬ÙˆØ¯

### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©: Ù„Ø§ ÙŠØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª
**Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©**:
- Service Account JSON ØºÙŠØ± ØµØ­ÙŠØ­
- Replit Secrets ØºÙŠØ± Ù…Ø¶Ø¨ÙˆØ·Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­

**Ø§Ù„Ø­Ù„**:
1. ØªØ­Ù‚Ù‚ Ù…Ù† Service Account JSON ÙÙŠ Replit Secrets
2. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù€ logs ÙÙŠ Backend
3. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Service Account ØµØ­ÙŠØ­

---

## ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©

### 1. Ø§Ù„Ø£Ù…Ø§Ù†
- âœ… **Ù„Ø§ ØªØ­ÙØ¸ Service Account JSON ÙÙŠ Ø§Ù„ÙƒÙˆØ¯**
- âœ… **Ø§Ø³ØªØ®Ø¯Ù… Replit Secrets ÙÙ‚Ø·**
- âœ… **Ù„Ø§ ØªØ´Ø§Ø±Ùƒ Private Key**

### 2. Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
- Service Account ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† "Manager" Ø£Ùˆ "Editor" Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¬Ù„Ø¯
- Ù„Ø§ ÙŠÙƒÙÙŠ Ø£Ù† ÙŠÙƒÙˆÙ† "Viewer"

### 3. Scopes
- Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: `https://www.googleapis.com/auth/drive.file`
- Ù‡Ø°Ø§ Ø§Ù„Ù€ scope ÙŠØ³Ù…Ø­ Ø¨Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª ÙÙ‚Ø·

---

## âœ… Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©

- [x] Folder ID: `1AvaKUW2VKb9t4O4Dwo_KXTntBfDQ1IYe`
- [x] Service Account Email: `nuzum-721@nuzum-477618.iam.gserviceaccount.com`
- [x] Project ID: `nuzum-477618`
- [ ] Service Account Ù„Ø¯ÙŠÙ‡ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¬Ù„Ø¯
- [ ] Google Drive API Ù…ÙØ¹Ù„
- [ ] Service Account JSON ÙÙŠ Replit Secrets
- [ ] Backend endpoint ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
- [ ] Flutter ÙŠØ±Ø³Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
- [ ] Ø§Ù„Ù…Ù„ÙØ§Øª ØªÙØ±ÙØ¹ Ø¹Ù„Ù‰ Drive Ø¨Ù†Ø¬Ø§Ø­
- [ ] `drive_url` ÙŠÙØ¹Ø§Ø¯ ÙÙŠ Ø§Ù„Ù€ response

---

## ğŸ“ Ø§Ù„Ø¯Ø¹Ù…

Ø¥Ø°Ø§ ÙˆØ§Ø¬Ù‡Øª Ø£ÙŠ Ù…Ø´Ø§ÙƒÙ„:
1. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù€ logs ÙÙŠ Backend
2. ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª Service Account
3. ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Folder ID ØµØ­ÙŠØ­
4. ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Google Drive API Ù…ÙØ¹Ù„
5. ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Service Account JSON ØµØ­ÙŠØ­ ÙÙŠ Replit Secrets

---

**Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:** 2025-01-27

