# ๐ ูุฑุงุฌุนุฉ ุงูุชูุงูู ูุน ูุซุงุฆู API - API Compliance Review

**ุชุงุฑูุฎ ุงููุฑุงุฌุนุฉ:** 10 ููููุจุฑ 2024  
**ุฅุตุฏุงุฑ API:** v1.0  
**ุฅุตุฏุงุฑ ุงูุชุทุจูู:** 1.0.0

---

## ๐ ููุฎุต ุงููุฑุงุฌุนุฉ

ุชูุช ูุฑุงุฌุนุฉ ุงูููุฏ ุงูุญุงูู ูููุงุฑูุชู ูุน ูุซุงุฆู API ุงูุฑุณููุฉ. ูุฐุง ุงูููู ููุถุญ:
- โ **ุงูุฃุฌุฒุงุก ุงููุชูุงููุฉ** ูุน ุงููุซุงุฆู
- โ๏ธ **ุงููุฑููุงุช** ุจูู ุงูููุฏ ูุงููุซุงุฆู
- ๐ง **ุงูุชูุตูุงุช** ููุชุญุฏูุซุงุช ุงููุทููุจุฉ

---

## ๐ 1. ุงููุตุงุฏูุฉ ูุงูุชุณุฌูู

### ุงููุซุงุฆู ุงูุฑุณููุฉ
```json
POST /api/v1/auth/login
{
  "employee_id": "EMP001",
  "password": "pass123"
}
```

### ุงูููุฏ ุงูุญุงูู
```dart
// lib/services/auth_service.dart
AuthService.login(
  employeeId: "EMP001",
  nationalId: "2290836975"  // โ๏ธ ูุณุชุฎุฏู national_id ุจุฏูุงู ูู password
)
```

### ๐ ุงููุฑู
- **ุงููุซุงุฆู:** ุชุณุชุฎุฏู `password` (ูููุฉ ูุฑูุฑ)
- **ุงูููุฏ ุงูุญุงูู:** ูุณุชุฎุฏู `national_id` (ุงููููุฉ ุงููุทููุฉ)

### ๐ก ุงูุชูุตูุฉ
**ุงููุถุน ุงูุญุงูู ุตุญูุญ** ุฅุฐุง ูุงู ุงููุธุงู ูุณุชุฎุฏู `national_id` ููููุฉ ูุฑูุฑ ูุนููุฉ.  
**ุฅุฐุง ูุงู ุงููุธุงู ูุชุทูุจ `password` ูููุตูุฉ:**
1. ุชุญุฏูุซ `AuthService.login()` ููุจูู `password` ุจุฏูุงู ูู `national_id`
2. ุชุญุฏูุซ `LoginScreen` ูุฅุถุงูุฉ ุญูู ูููุฉ ูุฑูุฑ
3. ุงูุชุฃูุฏ ูู ุฃู `national_id` ูุง ูุฒุงู ูุทููุจุงู ูู ููุงู ุขุฎุฑ

### โ ุงูุฃุฌุฒุงุก ุงููุชูุงููุฉ
- โ ุญูุธ Token ูู `flutter_secure_storage`
- โ ุฅุฑุณุงู Token ูู Header: `Authorization: Bearer {TOKEN}`
- โ ูุนุงูุฌุฉ ุฃุฎุทุงุก 401 (Unauthorized)
- โ ุญูุธ ุจูุงูุงุช ุงูููุธู ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู

---

## ๐ 2. ุทูุจุงุช ุบุณูู ุงูุณูุงุฑุงุช

### ุงููุซุงุฆู ุงูุฑุณููุฉ
```
POST /api/v1/requests/create-car-wash
Content-Type: multipart/form-data

Fields:
- vehicle_id (Integer, required)
- service_type (String, required): normal, polish, full_clean
- scheduled_date (Date, required)
- notes (String, optional)
- photo_plate (File, required)
- photo_front (File, required)
- photo_back (File, required)
- photo_right_side (File, required)
- photo_left_side (File, required)
```

### ุงูููุฏ ุงูุญุงูู
```dart
// lib/services/requests_api_service.dart - createCarWash()
FormData.fromMap({
  'vehicle_id': vehicleId,
  'service_type': serviceType,
  'scheduled_date': scheduledDate,
  'notes': notes,
  'photo_plate': MultipartFile.fromFile(...),
  'photo_front': MultipartFile.fromFile(...),
  'photo_back': MultipartFile.fromFile(...),
  'photo_right_side': MultipartFile.fromFile(...),
  'photo_left_side': MultipartFile.fromFile(...),
})
```

### โ ุงูุชูุงูู
- โ **ูุชูุงูู ุชูุงูุงู** - ุฌููุน ุงูุญููู ูุงูุฃุณูุงุก ูุทุงุจูุฉ ูููุซุงุฆู
- โ ุงุณุชุฎุฏุงู `multipart/form-data` ุจุดูู ุตุญูุญ
- โ ุงูุชุญูู ูู ูุฌูุฏ ุฌููุน ุงูุตูุฑ ุงูุฎูุณ ูุจู ุงูุฅุฑุณุงู
- โ ุถุบุท ุงูุตูุฑ ูุจู ุงูุฑูุน
- โ ูุนุงูุฌุฉ ุฃุฎุทุงุก 415 (Unsupported Media Type)

### ๐ ููุงุญุธุงุช
- ุงูููุฏ ูุณุชุฎุฏู `requested_date` ูู ุจุนุถ ุงูุฃูุงููุ ููู ุงููุซุงุฆู ุชุณุชุฎุฏู `scheduled_date` โ (ุชู ุงูุชุตุญูุญ)

---

## ๐ 3. ุทูุจุงุช ูุญุต ุงูุณูุงุฑุงุช

### ุงููุซุงุฆู ุงูุฑุณููุฉ
```
POST /api/v1/requests/create-car-inspection
Content-Type: multipart/form-data

Fields:
- vehicle_id (Integer, required)
- inspection_type (String, required): periodic, comprehensive, pre_sale
- inspection_date (Date, required)
- notes (String, optional)
- files (File[], required): 1-20 ุตูุฑุฉุ 0-3 ููุฏูู
```

### ุงูููุฏ ุงูุญุงูู
```dart
// lib/services/requests_api_service.dart - createCarInspection()
CarInspectionRequest.toJson() // ูุฑุณู JSON ููุทุ ูุง multipart
```

### โ๏ธ ุงููุฑู
- **ุงููุซุงุฆู:** ุชุชุทูุจ `multipart/form-data` ูุน ุฑูุน ูููุงุช ูุจุงุดุฑุฉ
- **ุงูููุฏ ุงูุญุงูู:** ูุฑุณู JSON ููุทุ ุซู ูุฑูุน ุงููููุงุช ูู ุฎุทูุฉ ูููุตูุฉ

### ๐ก ุงูุชูุตูุฉ
**ุงููุถุน ุงูุญุงูู ูุนูู** ุฅุฐุง ูุงู ุงูุณูุฑูุฑ ูุฏุนู ุฑูุน ุงููููุงุช ูู ุฎุทูุฉ ูููุตูุฉ.  
**ููุชูุงูู ุงููุงูู ูุน ุงููุซุงุฆู:**
1. ุชุญุฏูุซ `createCarInspection()` ูุงุณุชุฎุฏุงู `multipart/form-data`
2. ุฅุฑุณุงู ุฌููุน ุงููููุงุช ูุน ุงูุจูุงูุงุช ูู ุทูุจ ูุงุญุฏ
3. ุงุณุชุฎุฏุงู `files[]` ูุญูู ูุชุนุฏุฏ ุงููููุงุช

### ๐ ููุงุญุธุงุช
- **ุงููุฑู ุงููุจูุฑ:** ุงูููุฏ ุงูุญุงูู ูุณุชุฎุฏู ูุธุงู "ุชูุซูู" ุดุงูู ูููุณ ููุท "ูุญุต":
  - `vehicle_receipt` - ุงุณุชูุงู ุณูุงุฑุฉ
  - `vehicle_delivery` - ุชุณููู ุงูุณูุงุฑุฉ
  - `accident` - ุชูุซูู ุญุงุฏุซ
  - `monthly_inspection` - ุชูุชูุด ุดูุฑู
  - `delivery_to_workshop` - ุชุณููู ูู ูุฑุดุฉ
  - `receipt_from_workshop` - ุงุณุชูุงู ูู ูุฑุดุฉ
  
- ุงููุซุงุฆู ุชุณุชุฎุฏู ูุธุงู "ูุญุต" ููุท:
  - `periodic` - ูุญุต ุฏูุฑู
  - `comprehensive` - ูุญุต ุดุงูู
  - `pre_sale` - ูุญุต ูุจู ุงูุจูุน

- **ุงูุงุณุชูุชุงุฌ:** ูุจุฏู ุฃู ุงูููุฏ ุงูุญุงูู ูุณุชุฎุฏู ูุธุงูุงู ุฃูุซุฑ ุดููููุฉ ูู ุงููุซุงุฆู
- **ูุฌุจ ุงูุชุญูู ูู ุงูููู ุงูุตุญูุญุฉ ูุน ุงูุณูุฑูุฑ** - ูุฏ ุชููู ุงููุซุงุฆู ูุฏููุฉ ุฃู ุงูููุฏ ูุณุชุฎุฏู ูุธุงูุงู ูุฎุชููุงู

---

## ๐ 4. ุฅุฏุงุฑุฉ ุงูุทูุจุงุช ุงูุนุงูุฉ

### โ ุงูุชูุงูู
- โ `GET /api/v1/requests` - ูุชูุงูู
- โ `GET /api/v1/requests/{id}` - ูุชูุงูู
- โ `DELETE /api/v1/requests/{id}` - ูุชูุงูู (ูุน ุงูุชุญูู ูู ุญุงูุฉ PENDING)

---

## โ 5. ุงูููุงููุฉ/ุงูุฑูุถ (ููุฅุฏุงุฑููู)

### ุงููุซุงุฆู ุงูุฑุณููุฉ
```
POST /api/v1/requests/{request_id}/approve
POST /api/v1/requests/{request_id}/reject
```

### ุงูููุฏ ุงูุญุงูู
- โ **ุบูุฑ ููุฌูุฏ** - ูุง ุชูุฌุฏ ุฏูุงู ููููุงููุฉ/ุงูุฑูุถ

### ๐ก ุงูุชูุตูุฉ
ุฅุถุงูุฉ ุฏูุงู ููููุงููุฉ/ุงูุฑูุถ ุฅุฐุง ูุงู ุงูุชุทุจูู ูุฏุนู ุตูุงุญูุงุช ุฅุฏุงุฑูุฉ:
```dart
static Future<Map<String, dynamic>> approveRequest(int requestId, {String? adminNotes}) async {
  // Implementation
}

static Future<Map<String, dynamic>> rejectRequest(int requestId, String rejectionReason) async {
  // Implementation
}
```

---

## ๐ 6. ุงูุฅุญุตุงุฆูุงุช

### ุงููุซุงุฆู ุงูุฑุณููุฉ
```
GET /api/v1/requests/statistics
GET /api/v1/vehicles
GET /api/v1/notifications
```

### ุงูููุฏ ุงูุญุงูู
- โ `GET /api/v1/requests/statistics` - ูุชูุงูู (ูู `getMyRequests`)
- โ `GET /api/v1/vehicles` - ุบูุฑ ููุฌูุฏ
- โ `GET /api/v1/notifications` - ุบูุฑ ููุฌูุฏ

### ๐ก ุงูุชูุตูุฉ
ุฅุถุงูุฉ ุฏูุงู ูุฌูุจ ุงูุณูุงุฑุงุช ูุงูุฅุดุนุงุฑุงุช ุฅุฐุง ูุงูุช ูุทููุจุฉ:
```dart
static Future<List<Vehicle>> getVehicles() async {
  // Implementation
}

static Future<List<Notification>> getNotifications({bool unreadOnly = false}) async {
  // Implementation
}
```

---

## ๐ง 7. ุงูุชุญุฏูุซุงุช ุงูููุตู ุจูุง

### ุฃููููุฉ ุนุงููุฉ ๐ด
1. **ุงูุชุญูู ูู ูุธุงู ุงููุตุงุฏูุฉ:**
   - ุชุฃููุฏ ูุง ุฅุฐุง ูุงู ุงููุธุงู ูุณุชุฎุฏู `password` ุฃู `national_id`
   - ุชุญุฏูุซ ุงูููุฏ ุญุณุจ ุงููุธุงู ุงููุนูู

2. **ุงูุชุญูู ูู ูุธุงู ุงูุชูุซูู/ุงููุญุต:**
   - **ุงูููุฏ ุงูุญุงูู** ูุณุชุฎุฏู ูุธุงู "ุชูุซูู" ุดุงูู (6 ุญุงูุงุช)
   - **ุงููุซุงุฆู** ุชุณุชุฎุฏู ูุธุงู "ูุญุต" ููุท (3 ุฃููุงุน)
   - **ูุฌุจ ุงูุชุญูู:** ูู ุงููุธุงู ูุฏุนู ููุง ุงููุธุงูููุ ุฃู ุฃู ุงููุซุงุฆู ูุฏููุฉุ
   - ุฅุฐุง ูุงู ุงููุธุงู ูุฏุนู ูุธุงู ุงูุชูุซูู ุงูุดุงููุ ูุฌุจ ุชุญุฏูุซ ุงููุซุงุฆู
   - ุฅุฐุง ูุงู ุงููุธุงู ูุฏุนู ูุธุงู ุงููุญุต ููุทุ ูุฌุจ ุชุญุฏูุซ ุงูููุฏ

### ุฃููููุฉ ูุชูุณุทุฉ ๐ก
3. **ุชุญุฏูุซ `createCarInspection()`:**
   - ุงุณุชุฎุฏุงู `multipart/form-data` ุฅุฐุง ูุงู ุงูุณูุฑูุฑ ูุฏุนูู
   - ุฅุฑุณุงู ุงููููุงุช ูุน ุงูุจูุงูุงุช ูู ุทูุจ ูุงุญุฏ

4. **ุฅุถุงูุฉ ุฏูุงู ุงูููุงููุฉ/ุงูุฑูุถ:**
   - ุฅุฐุง ูุงู ุงูุชุทุจูู ูุฏุนู ุตูุงุญูุงุช ุฅุฏุงุฑูุฉ

### ุฃููููุฉ ููุฎูุถุฉ ๐ข
5. **ุฅุถุงูุฉ ุฏูุงู ุงูุฅุญุตุงุฆูุงุช:**
   - `getVehicles()`
   - `getNotifications()`

---

## ๐ 8. ููุงุญุธุงุช ูููุฉ

### โ ูุง ูุนูู ุจุดูู ุตุญูุญ
- โ ุฌููุน ุทูุจุงุช ุบุณูู ุงูุณูุงุฑุงุช ูุชูุงููุฉ ุชูุงูุงู
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุดุงููุฉ
- โ ุงุณุชุฎุฏุงู `multipart/form-data` ุตุญูุญ
- โ ุถุบุท ุงูุตูุฑ ูุจู ุงูุฑูุน
- โ ุญูุธ Token ุจุดูู ุขูู

### โ๏ธ ูุง ูุญุชุงุฌ ูุฑุงุฌุนุฉ
- โ๏ธ ูุธุงู ุงููุตุงุฏูุฉ (`password` vs `national_id`)
- โ๏ธ ููู `inspection_type` ูู ุทูุจุงุช ุงููุญุต
- โ๏ธ ุทุฑููุฉ ุฑูุน ูููุงุช ุงููุญุต (JSON vs multipart)

### ๐ ุงูุฃูุงู
- โ Token ูุญููุธ ูู `flutter_secure_storage`
- โ Token ูุถุงู ุชููุงุฆูุงู ูู ุฌููุน ุงูุทูุจุงุช
- โ ูุนุงูุฌุฉ ุงูุชูุงุก ุตูุงุญูุฉ Token (401)

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ุงูุชุญูู ูุน ูุฑูู Backend:**
   - ุชุฃููุฏ ูุธุงู ุงููุตุงุฏูุฉ (`password` vs `national_id`)
   - ุชุฃููุฏ ููู `inspection_type` ุงูุตุญูุญุฉ
   - ุชุฃููุฏ ุทุฑููุฉ ุฑูุน ูููุงุช ุงููุญุต

2. **ุงูุชุญุฏูุซุงุช ุงููุทููุจุฉ:**
   - ุชุญุฏูุซ ุงูููุฏ ุญุณุจ ูุชุงุฆุฌ ุงูุชุญูู
   - ุงุฎุชุจุงุฑ ุฌููุน ุงูุณููุงุฑูููุงุช

3. **ุงูุชูุซูู:**
   - ุชุญุฏูุซ ูุฐุง ุงูููู ุจุนุฏ ุงูุชุญุฏูุซุงุช
   - ุฅุถุงูุฉ ุฃูุซูุฉ ููุงุณุชุฎุฏุงู

---

**ุขุฎุฑ ุชุญุฏูุซ:** 10 ููููุจุฑ 2024  
**ุงูุญุงูุฉ:** ููุฏ ุงููุฑุงุฌุนุฉ

